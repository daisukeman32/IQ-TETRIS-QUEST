# IQ TETRIS QUEST 要件定義書

## 概要

クイズに答えながらテトリスをプレイする教育エンターテインメントゲーム。
敵キャラクターを倒すRPG要素を組み合わせ、最後にIQスコアが表示される。

**2種類のバージョンを作成：**
1. **通常版** - レトロなドット絵風デザイン（黒背景・ドラクエ風）
2. **カワイイ版** - パステルピンク基調の可愛いデザイン

---

## 技術仕様

- **言語**: HTML5, CSS3, JavaScript (Vanilla)
- **ファイル構成**: index.html, style.css, game.js
- **外部依存**: Google Fonts のみ
- **対応環境**: PC/スマホブラウザ（Chrome, Safari, Firefox）

---

## 画面構成

### 1. スプラッシュ画面
- ロゴ画像表示
- 「タップしてスタート」テキスト（点滅アニメーション）
- タップでオーディオ初期化 → タイトル画面へ

### 2. タイトル画面
- ロゴ画像
- **対象者選択**（クイズ内容が変わる）
  - ていがくねん（小学1-3年向け）
  - こうがくねん（小学4-6年向け）
  - おとな
  - ★ げきムズ（超難問）
- **難易度選択**（落下速度・敵HPが変わる）
  - かんたん
  - ふつう
  - むずかしい
  - ★ げきムズ
- ルールを見るボタン
- ゲーム開始ボタン
- BGM: オープニング曲（ループ再生）

### 3. ルール画面
- 遊び方説明
- 戻るボタン

### 4. ゲーム画面
**レイアウト（PC）**: 左に敵情報、中央にテトリス盤面、右にクイズ・操作説明
**レイアウト（スマホ）**: 上から敵情報→盤面→クイズの縦配置

**構成要素:**
- 敵キャラクター（絵文字）+ 名前 + HPバー
- テトリス盤面（10列×20行）
- クイズ表示エリア（問題文 + 4択ボタン）
- リセットボタン（1回だけブロックをリセットできる）
- タイトルへ戻るボタン（モバイルは左上固定）
- 音量ON/OFFボタン（右上固定）

### 5. 結果画面（フルスクリーンオーバーレイ）
- VICTORY! または GAME OVER
- 倒した/負けた敵の名前
- **IQスコア（大きく表示）**
- IQに応じたコメント
- 正解率・間違い回数
- 「タップでタイトルへ」
- BGM: エンディング曲

---

## ゲームロジック

### テトリス基本仕様
- 盤面: 10列 × 20行
- 7種類のテトリミノ（I, O, T, S, Z, J, L）
- 操作: 左右移動、下移動（落下）、回転
- ライン消去でダメージ（1列=10, 2列=30, 3列=60, 4列=100）
- ブロックが最上段に達したらゲームオーバー

### クイズシステム
- **正解するまでブロック操作不可**
- 正解 → 操作可能になる
- 不正解 → 敵の攻撃（落下速度UP）、次の問題へ
- ブロックが着地したら次のクイズ出題

### 敵システム
**通常版の敵:**
| 難易度 | 名前 | 絵文字 | HP |
|--------|------|--------|-----|
| かんたん | スライム | 🟢 | 50 |
| ふつう | ゴブリン | 👺 | 100 |
| むずかしい | ドラゴン | 🐉 | 150 |
| げきムズ | 魔王 | 😈 | 200 |

**カワイイ版の敵:**
| 難易度 | 名前 | 絵文字 | HP |
|--------|------|--------|-----|
| かんたん | ふわふわうさぎ | 🐰 | 50 |
| ふつう | きらきらねこ | 🐱 | 100 |
| むずかしい | にんぎょひめ | 🧜‍♀️ | 150 |
| げきムズ | ゆめゆめユニコーン | 🦄 | 200 |

### IQ計算式
```
基礎IQ = 100
+ (正解数 × 3)
- (間違い数 × 5)
+ (敵を倒した場合のボーナス: 難易度に応じて10-25)
+ (難易度ボーナス: 対象者・速度に応じて加算)
範囲: 50〜200
```

### IQコメント
| IQ範囲 | コメント |
|--------|----------|
| 180+ | 天才！アインシュタイン級！ |
| 160-179 | 超優秀！未来のリーダー！ |
| 140-159 | すごい！頭脳明晰！ |
| 120-139 | 優秀！よく頑張った！ |
| 100-119 | 平均以上！いい感じ！ |
| 80-99 | もう少し頑張ろう！ |
| 80未満 | 気にしない！楽しむことが大事！ |

---

## クイズデータ構造

```javascript
const quizData = {
    lowerElem: [  // ていがくねん
        { q: '問題文', o: ['選択肢1', '選択肢2', '選択肢3', '選択肢4'], a: '正解' },
        // ...
    ],
    upperElem: [],  // こうがくねん
    adult: [],      // おとな
    extra: []       // げきムズ
};
```

**クイズ内容の目安:**
- ていがくねん: 簡単な算数、ひらがな、動物、色など
- こうがくねん: 漢字、理科、社会、ことわざなど
- おとな: 一般常識、時事、雑学など
- げきムズ: 難問クイズ、専門知識など

---

## 音声ファイル一覧

| ファイル名 | 用途 |
|-----------|------|
| オープニング.mp3 | タイトル画面BGM（ループ） |
| BGM2.mp3 | ゲームプレイ中BGM（ループ） |
| エンディング.mp3 | 結果画面BGM（ループ） |
| カーソル移動11.mp3 | メニュー選択音 |
| 決定ボタンを押す.mp3 | 決定音 |
| クイズ正解1.mp3 | 正解時SE |
| クイズ不正解1.mp3 | 不正解時SE |
| 攻撃2.mp3 | ライン消去時SE |
| おたすけ.mp3 | リセット使用時SE |
| 大勢で拍手.mp3 | クリア時SE |
| 「おめでとう」.mp3 | クリア時ボイス |

**カワイイ版追加:**
| ファイル名 | 用途 |
|-----------|------|
| オープニングカワイイ.mp3 | タイトル画面BGM |
| エンディングカワイイ.mp3 | 結果画面BGM |

---

## デザイン仕様

### 通常版
- **テーマ**: レトロゲーム風、ドラクエ風
- **背景色**: 黒 (#000)
- **フォント**: DotGothic16（ドット絵風）
- **ブロック色**: 原色系（赤、青、緑、黄など）
- **UIカラー**: 白文字、グレーボーダー
- **結果画面**: 黒背景オーバーレイ

### カワイイ版
- **テーマ**: パステル、ゆめかわいい
- **背景色**: ピンクグラデーション (#FFE4EC → #FFF0F5)
- **フォント**: Zen Maru Gothic（丸ゴシック）
- **ブロック色**: パステル系（濃いめで視認性確保）
- **UIカラー**: ピンク (#FF69B4)、ラベンダー
- **結果画面**: ピンクグラデーション + ♡✧装飾アニメーション
- **特徴**: 角丸多め、影にピンク、可愛い絵文字使用

---

## レスポンシブ対応

### PC (768px以上)
- 横並びレイアウト（敵情報・盤面・クイズ）
- キーボード操作（矢印キー）

### スマホ (768px未満)
- 縦並びレイアウト
- スワイプ操作（左右移動、下スワイプで落下）
- タップで回転
- 長押しで即落下
- タイトルへ戻るボタン: 左上固定（誤タップ防止）
- 音量ボタン: 右上固定

---

## 実装上の注意点

1. **モバイルオーディオ**: 最初のユーザー操作後に音声再生を開始
2. **結果画面BGM**: 100ms遅延を入れて再生（モバイル対応）
3. **Canvas描画**: requestAnimationFrameでループ
4. **クイズ選択**: ランダムだが同じ問題が連続しないよう制御
5. **リセット機能**: 1ゲーム1回のみ使用可能

---

## 同梱アセット

`/assets/` フォルダに以下を配置:
- 音声ファイル（上記一覧参照）
- ロゴ画像（iqtetrisquestロゴ.png）

※クイズデータは game.js 内に直接記述

---

*この要件定義書をClaudeに渡せば、同等のゲームを生成できます。*
